## Пз № 3 25.10.2025

### Полезные статьи

[RSA-числа](https://ru.wikipedia.org/wiki/RSA-числа)

# RSA (первые буквы фамилий создателей алгоритма)

<u>*_Асимметричное шифрование_*</u>:\
$x: -> f(x)$ легко получить \
$f(x) -> x$ трудно получить

Все простые числа можно представить в виде $6n \pm 1$

### Алгоритм:

1) Сгенерировать простые два числа p = 10...., q = 11.... заданной одинаковой длинны, $p \neq q$ $|p - q| > 2^512$
    1) gcd
       ```C++
       gcq(a, b){
            while (a != 0){
                temp = b % a;
                b = a;
                a = temp;
            }
            return b;
       }
           
       ```
    2) gcdext
    3) modexp\
       Арифметика остатков:\
       $a \equiv b \pmod m $ 
        1) $a_1 == a_2 \pmod m$; $b_1 == b_2 \pmod m$; -> $a_1 + b_1 == a_2 + b_2 \pmod m$;
        2) $a \mod m \equiv b \mod m$; $a \cdot b \equiv c \pmod m$; $(a \mod m) \cdot (b \mod m) \equiv c \mod m$
       ```c++
       int Fast_pow(a, deg, m){
         res = a;
         while (deg != 1) {
           if (deg & 1 == 1){
               res *= a % m;
           }
           res *= res;
           deg >>= 1;
         }
       return res;
       }
       ```
    4) Малая теорема Ферма: \
       $a^{n-1} \equiv 1 \pmod n$ n, которая не удовлетворяет этому равенству составное\
       $a^{\varphi(n)} \equiv 1 \pmod n$\
       $\varphi(p) = p - 1$
    5) Тест Ферма:
        1) Цикл от 1 до k
        2) $a \in [2; n -1]$ псевдослучайно и исключаем его из этого отрезка _(a называются свидетелями простоты)_
        3) $gcd(a, n)$, если 1 идём дальше, иначе возвращаем что число составное (без этого шага можно нарваться на
           Числа Кармайкла)
        4) $a^{n-1} \equiv 1 \pmod n$, если False возвращаем, что оно составное, иначе идём в шаг 1
        5) После цикла возвращаем Число простое с вероятностью $1 - \frac{1}{2^k}$\
           Числа Кармайкла - такие составные числа n,
           что $\forall (a \in [2; n -1], gcd(a, n) = 1) : a^{n-1} \equiv 1 \pmod n$\
           Пример: $561 = 2 \cdot 11 \cdot 17$
    6) Число $а$ является квадратичным вычетом по модулю m если $\exists x: x^2 \equiv a \pmod m $\
       Пример: $a = 0$ для всех $m$ квадратичный вычет\
       для m = 2 : $\forall a$ - квадратичный вычет\
       для m = 3 : Подходят классы вычетов (обычные, не квадратичные) $C_0$ и $C_1$
    7) Символ Лежандра: \
       Пусть $a \in Z$, $a$ - нечётное число и $p \neq 2 \in \mathbb{P}$.\
       Тогда Символ Лежандра $s = \left(\frac{a}{p}\right)$:
        1) s = 0 то a делится на p
        2) s = 1 a - квадратичный вычет по модулю p
        3) s = -1 a - квадратичный невычет по модулю p \
           Свойства:
        - $\left(\frac{a \cdot b}{p}\right) = \left(\frac{a}{p}\right) \cdot \left(\frac{b}{p}\right)$
        - Критерий Эйлера: $\left(\frac{a}{p}\right) \equiv a^{\frac{p-1}{2}} \pmod p$
        - Квадратичный закон
          взаимности: $\left(\frac{q}{p}\right) \equiv a^{\frac{p-1}{2} \cdot \frac{q-1}{2}} \cdot \left(\frac{q}{p}\right) \pmod p$
    8) Символ Якоби: \
       $P$ - нечётное число, $P > 1$, $a$ - нечётное целое число или 0\
       $P = (p_1)^{\alpha_1} \cdot (p_2)^{\alpha_2} \cdot ... \cdot (p_n)^{\alpha_n}$\
       $\left(\frac{a}{p}\right) = \left(\frac{a}{p_1}\right)^{\alpha_1} \cdot \left(\frac{a}{p_2}\right)^{\alpha_2} \cdot ... \cdot \left(\frac{a}{p_n}\right)^{\alpha_n}$\
       Свойств с. Якоби:
        - $\left(\frac{a \cdot b}{p}\right) = \left(\frac{a}{p}\right) \cdot \left(\frac{b}{p}\right) \implies \left(\frac{a^2 \cdot b}{p}\right) = \left(\frac{b}{p}\right)$
        - $\left(\frac{1}{p}\right) = 1$
        - $\left(\frac{-1}{p}\right) = -1^{\frac{p - 1}{2}}$
        - $\left(\frac{Q}{P}\right) \cdot \left(\frac{P}{Q}\right) = (-1)^{\frac{P-1}{2} \cdot \frac{Q-1}{2}}$
    9) Тест Соловей-Штрассена: \
       $n > 2$, $n \in \mathbb{P}$, $p$ - необходимая вероятность $p = 1 - \frac{1}{2^k}$
        1) Цикл $i = 1, 2, ..., k$:
        2) Выбираем $a \in [2; n-1]$
        3) Если $gcd(a, n) \neq 1 \to$ составное
        4) Если $a^{\frac{n-1}{2}} \neq \left(\frac{a}{n}\right) \pmod n \to$ составное
        5) После цикла число простое с вероятностью $1 - \frac{1}{2^k}$
    10) Тест Миллера-Рабина: \
        $n > 2$, $n$ - нечётное, $p$ - необходимая вероятность $p = 1 - \frac{1}{4^k}$:
        1) $n-1=2^s \cdot t$, где $t$ - нечётное, $s$ - максимальная степень двойки входящая в $n-1$
        2) Цикл $i = 1, 2, ..., k$
            1) Выбрать $a \in [2; n-2]$
            2) $x = a^t \mod n$
            3) Если $x = 1$ или $x = n - 1$: continue
            4) Иначе: Цикл j = 1, ..., s - 1
                1) $x = x^2 \mod n$
                2) Если $x = 1 \to$ составное
                3) $x = n - 1 \to$ следующая итерация внешнего цикла
            5) return Составное
        3) return простое с вероятностью $p$

2) $N = p \cdot q$, $N$ - модуль
3) $\varphi(N) = \varphi(p \cdot q) = \varphi(p) \cdot \varphi(q) = (p - 1) \cdot (q - 1)$
4) $e: 1 < e < \varphi(N)$, $gcd(e, \varphi(N))$, где $e$ - открытая экспонента (стремимся чтобы $1$ в числе было как можно
   меньше) $e = 17$, $e = 257$, $e = 65537$ (Последнее предпочтительнее)
5) $d: d \cdot e \equiv 1 \pmod{\varphi(N)}$ d можно найти через расширенный алгоритм Евклида (быстрее) или $d = e^{\varphi(N) - 1}$
6) $(e, N)$ - публичный ключ
7) $(d, N)$  - закрытий ключ
8) $C = E(m) = m^e \mod N$ размер блока должен быть ограничен
9) $m = D(C) = C^d \mod N$